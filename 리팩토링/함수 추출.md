# 함수 추출

## 원본 코드

```js
export function printOwing(invoice) {
  let outstanding = 0;

  console.log('***********************');
  console.log('**** Customer Owes ****');
  console.log('***********************');

  // calculate outstanding
  for (const o of invoice.orders) {
    outstanding += o.amount;
  }

  // record due date
  const today = new Date();
  invoice.dueDate = new Date(
    today.getFullYear(),
    today.getMonth(),
    today.getDate() + 30
  );

  //print details
  console.log(`name: ${invoice.customer}`);
  console.log(`amount: ${outstanding}`);
  console.log(`due: ${invoice.dueDate.toLocaleDateString()}`);
}

const invoice = {
  orders: [{ amount: 2 }, { amount: 5 }],
  customer: '엘리',
};
printOwing(invoice);
```

## 수정 코드

```js
export function printOwing(invoice) {
	printBanner();
	const outstanding = calculateOutstanding;
	recordDueData(invoice);
	printDetails(invoice, outstanding);
}

function printBanner() {
	console.log('***********************');
	console.log('**** Customer Owes ****');
	console.log('***********************');
}

function calculateOutstanding(invoice) {
	return invoice.orders.reduce((sum, order) => sum + order, 0);
}

function recordDueData(invoice) {
	const today = new Date();
	invoice.dueDate = new Date(today.getFullYear(), today.getMonth(), today.getDate() + 30);
}

function printDetails(invoice, outstanding) {
	console.log(`name: ${invoice.customer}`);
	console.log(`amount: ${outstanding}`);
	console.log(`due: ${invoice.dueDate.toLocaleDateString()}`);
}

const invoice = {
	orders: [{ amount: 2 }, { amount: 5 }],
	customer: '엘리',
};
printOwing(invoice);
```

1. 함수를 추출하여, 주석을 없애고 함수명이 주석의 역할을 한다.
2. for문 대신 reduce를 사용하여 절차형이 아닌 함수형으로 작성한다.
3. for문을 사용한다고 가정하였을 때는 다음과 같이 함수 내부에서 반환 값은 result로 변수를 선언하고 반환해주는 것이 직관적이다.
```js
function calculateOutstanding(invoice) {
  let result = 0;
  for (const o of invoice.orders) {
    result += o.amount;
  }
  return result
}
```
4. 예전에는 원본 코드처럼 함수의 시작부에 모든 변수를 선언 하고 시작하는 스타일이 많이 있었으나, 최근에는 다음과 같이 사용되는 로직 근처에서 선언하는 방식을 많이 사용한다.
```js
export function printOwing(invoice) {

  console.log('***********************');
  console.log('**** Customer Owes ****');
  console.log('***********************');

  let outstanding = 0; // 사용되는 로직 앞에서 선언
  for (const o of invoice.orders) {
    outstanding += o.amount;
  }
  ...
}
```